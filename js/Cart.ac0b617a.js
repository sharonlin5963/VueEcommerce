(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["Cart"],{8418:function(t,e,a){"use strict";var s=a("c04e"),i=a("9bf2"),n=a("5c6c");t.exports=function(t,e,a){var r=s(e);r in t?i.f(t,r,n(0,a)):t[r]=a}},"98ab":function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"alert"},[a("div",[t._v(t._s(t.title))]),a("router-link",{staticClass:"e-btn",attrs:{to:{name:"ItemList"}}},[t._v(t._s(t.btnMsg))])],1)},i=[],n={name:"Alert",props:{title:String,btnMsg:String}},r=n,c=a("2877"),o=Object(c["a"])(r,s,i,!1,null,null,null);e["a"]=o.exports},a434:function(t,e,a){"use strict";var s=a("23e7"),i=a("23cb"),n=a("a691"),r=a("50c4"),c=a("7b0b"),o=a("65f0"),l=a("8418"),u=a("1dde"),d=a("ae40"),m=u("splice"),v=d("splice",{ACCESSORS:!0,0:0,1:2}),h=Math.max,p=Math.min,f=9007199254740991,_="Maximum allowed length exceeded";s({target:"Array",proto:!0,forced:!m||!v},{splice:function(t,e){var a,s,u,d,m,v,g=c(this),C=r(g.length),k=i(t,C),b=arguments.length;if(0===b?a=s=0:1===b?(a=0,s=C-k):(a=b-2,s=p(h(n(e),0),C-k)),C+a-s>f)throw TypeError(_);for(u=o(g,s),d=0;d<s;d++)m=k+d,m in g&&l(u,d,g[m]);if(u.length=s,a<s){for(d=k;d<C-s;d++)m=d+s,v=d+a,m in g?g[v]=g[m]:delete g[v];for(d=C;d>C-s+a;d--)delete g[d-1]}else if(a>s)for(d=C-s;d>k;d--)m=d+s-1,v=d+a-1,m in g?g[v]=g[m]:delete g[v];for(d=0;d<a;d++)g[d+k]=arguments[d+2];return g.length=C-s+a,u}})},a623:function(t,e,a){"use strict";var s=a("23e7"),i=a("b727").every,n=a("a640"),r=a("ae40"),c=n("every"),o=r("every");s({target:"Array",proto:!0,forced:!c||!o},{every:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}})},c228:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"max-1600"},[t.alert.open?s("Alert",{attrs:{title:t.alert.title,btnMsg:t.alert.btnMsg}}):t._e(),s("div",{staticClass:"m-cartSpace"},[s("CartStep",{attrs:{hasClass:!0}}),s("div",{staticClass:"m-list shopList"},[s("div",{staticClass:"title"},[t._v("購物清單")]),s("hr"),0===t.cartList.length?s("div",{key:"cartList",staticClass:"noItem"},[t._v("購物車內沒有商品 ")]):s("div",[t._l(t.cartList,(function(e,i){return s("div",{key:i},[s("div",{staticClass:"shopList_item",class:e.isDiscount?"isSale":""},[s("div",{staticClass:"e-btn delete",on:{click:function(e){return t.deleteItem(i)}}},[t._v("X")]),s("div",{staticClass:"item_pic"},[s("img",{attrs:{src:a("b967")("./"+e.img_name+".png"),alt:""}})]),s("div",{staticClass:"item_name"},[t._v(t._s(e.name)+" "),s("br"),s("span",{staticClass:"product_price"},[t._v("NT."+t._s(e.price))]),s("span",{staticClass:"product_salePrice"},[t._v("NT."+t._s(Math.round(e.price*e.discount)))])]),s("div",{staticClass:"quantity"},[s("div",{staticClass:"symbol",on:{click:function(e){return t.calculate(-1,i)}}},[t._v("-")]),s("div",{staticClass:"value"},[t._v(t._s(e.quantity))]),s("div",{staticClass:"symbol",on:{click:function(e){return t.calculate(1,i)}}},[t._v("+")])])]),s("hr")])})),s("div",{staticClass:"total"},[s("span",[t._v("共")]),s("span",{staticClass:"totalCount"},[t._v(" "+t._s(t.addTotalItem)+" ")]),s("span",[t._v("件商品")]),s("span",[t._v(" 總計")]),s("span",{staticClass:"totalPrice"},[t._v(" NT."+t._s(t.addTotalPrice))])]),s("div",{staticClass:"nextBtn"},[s("div",{staticClass:"e-btn goCheckout",on:{click:function(e){return t.nextStep()}}},[t._v("下一步")])])],2)]),s("div",{staticClass:"m-list orderInfo"},[s("div",{staticClass:"title"},[t._v("訂單資訊")]),s("div",{staticClass:"orderInfo_info"},[s("div",{staticClass:"row"},[s("div",{staticClass:"col col-md-6 col-12 orderInfo_title",class:t.check.name?"fail":""},[t._v("姓名 "),s("div",{staticClass:"failState"},[t._v("*此為必填問題")]),s("br"),s("input",{directives:[{name:"model",rawName:"v-model",value:t.customerInfo.name,expression:"customerInfo.name"}],attrs:{type:"text"},domProps:{value:t.customerInfo.name},on:{blur:function(e){return t.checkHandler("name")},input:function(e){e.target.composing||t.$set(t.customerInfo,"name",e.target.value)}}})]),s("div",{staticClass:"col col-md-6 col-12 orderInfo_title ",class:t.check.phone?"fail":""},[t._v("聯絡電話 "),s("div",{staticClass:"failState"},[t._v("*電話必須為10位數字")]),s("br"),s("input",{directives:[{name:"model",rawName:"v-model",value:t.customerInfo.phone,expression:"customerInfo.phone"}],attrs:{type:"text"},domProps:{value:t.customerInfo.phone},on:{blur:function(e){return t.checkHandler("phone")},input:function(e){e.target.composing||t.$set(t.customerInfo,"phone",e.target.value)}}})])]),s("div",{staticClass:"orderInfo_title",class:t.check.addr?"fail":""},[t._v("收件地址 "),s("div",{staticClass:"failState"},[t._v("*此為必填問題")]),s("br"),s("input",{directives:[{name:"model",rawName:"v-model",value:t.customerInfo.addr,expression:"customerInfo.addr"}],attrs:{type:"text"},domProps:{value:t.customerInfo.addr},on:{blur:function(e){return t.checkHandler("addr")},input:function(e){e.target.composing||t.$set(t.customerInfo,"addr",e.target.value)}}})]),s("div",{staticClass:"orderInfo_title",class:t.check.mail?"fail":""},[t._v("郵件地址 "),s("div",{staticClass:"failState"},[t._v("*請輸入正確的Email格式")]),s("br"),s("input",{directives:[{name:"model",rawName:"v-model",value:t.customerInfo.mail,expression:"customerInfo.mail"}],attrs:{type:"text"},domProps:{value:t.customerInfo.mail},on:{blur:function(e){return t.checkHandler("mail")},input:function(e){e.target.composing||t.$set(t.customerInfo,"mail",e.target.value)}}})]),s("div",{staticClass:"orderInfo_title"},[t._v("備註 "),s("br"),s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.customerInfo.remark,expression:"customerInfo.remark"}],attrs:{name:"text"},domProps:{value:t.customerInfo.remark},on:{input:function(e){e.target.composing||t.$set(t.customerInfo,"remark",e.target.value)}}})])]),s("div",{staticClass:"nextBtn"},[s("div",{staticClass:"e-btn",on:{click:function(e){return t.checkOut()}}},[t._v("結帳")])])])],1),t.loading?s("Loading"):t._e()],1)},i=[],n=(a("a623"),a("a434"),a("b0c0"),a("07ac"),a("ce4a")),r=a("98ab"),c=a("3a5e"),o=a("1157"),l=a.n(o),u=a("2b0e"),d={name:"Cart",components:{CartStep:n["a"],Alert:r["a"],Loading:c["a"]},data:function(){return{cartList:[],totalPrice:0,totalItem:0,alert:{open:!1,title:"您的購物車沒有商品",btnMsg:"去逛逛"},number:"",loading:!1,customerInfo:{name:"",phone:"",addr:"",mail:"",remark:""},check:{name:!1,phone:!1,addr:!1,mail:!1},checkOff:!1}},created:function(){var t=this;this.loading=!0,u["a"].axios.get("https://ancient-dusk-35329.herokuapp.com/cart").then((function(e){t.cartList=e.data,t.loading=!1})).catch((function(t){console.log(t)}))},methods:{nextStep:function(){var t=l()(".orderInfo").offset().top;l()("body,html").stop().animate({scrollTop:t})},calculate:function(t,e){var a=this,s=this.cartList[e],i=parseInt(s.quantity);if(this.number=parseInt(s.quantity),i+=t,i<1)return 1;s.quantity=i;var n=s.id;this.number!==i&&(this.loading=!0,u["a"].axios.patch("https://ancient-dusk-35329.herokuapp.com/cart/"+n,{quantity:i}).then((function(){a.loading=!1})).catch((function(t){console.log(t)})))},deleteItem:function(t){var e=this;this.loading=!0;var a=this.cartList[t].id;u["a"].axios.delete("https://ancient-dusk-35329.herokuapp.com/cart/"+a).then((function(){e.loading=!1,e.cartList.splice(t,1)})).catch((function(t){console.log(t)}))},checkHandler:function(t){if(0===this.cartList.length)return this.alert.open=!0;var e=this.customerInfo,a=e.name,s=e.phone,i=e.addr,n=e.mail,r=/^0[0-9]{9}$/,c=/^([a-zA-Z0-9._%-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4})*$/;if("name"===t){if(!a)return this.check.name=!0;this.check.name=!1}if("addr"===t){if(!i)return this.check.addr=!0;this.check.addr=!1}if("phone"===t){if(!r.test(s))return this.check.phone=!0;this.check.phone=!1}if("mail"===t){if(!n||!c.test(n))return this.check.mail=!0;this.check.mail=!1}},checkOut:function(){var t=this,e=Object.values(this.check),a=Object.values(this.customerInfo);e.every((function(t){return!1===t}))&&(this.loading=!0,a.push(this.addTotalItem),a.push(this.addTotalPrice),this.$emit("sendList",a,this.cartList),u["a"].axios.put("https://ancient-dusk-35329.herokuapp.com/orderList",{list:a}).then((function(){t.loading=!1})).catch((function(t){console.log(t)})),l()("body,html").scrollTop(0),this.$router.push({name:"Cart-checkout"}))}},computed:{addTotalItem:function(){var t=this.cartList,e=this.totalItem;e=0;for(var a=0;a<t.length;a++)e+=parseInt(t[a].quantity);return e},addTotalPrice:function(){var t=this.cartList,e=this.totalPrice;e=0;for(var a=0;a<t.length;a++)e+=Math.round(t[a].price*t[a].discount)*t[a].quantity;return e}},watch:{addTotalItem:function(t){var e=this;this.$emit("TotalItem",t),this.loading=!0,u["a"].axios.put("https://ancient-dusk-35329.herokuapp.com/total",{item:this.addTotalItem}).then((function(){e.loading=!1})).catch((function(t){console.log(t)}))}}},m=d,v=a("2877"),h=Object(v["a"])(m,s,i,!1,null,null,null);e["default"]=h.exports},ce4a:function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"m-step h-flexCenter"},[a("div",{staticClass:"step_block e-btn",class:t.hasClass?"active":""},[a("span",[t._v("01")]),a("span",[t._v(" 輸入訂單資料")])]),a("div",{staticClass:"step_arrow"},[t._v("►")]),a("div",{staticClass:"step_block e-btn",class:t.hasClass?"":"active"},[a("span",[t._v("02")]),a("span",[t._v(" 確認付款")])]),a("div",{staticClass:"step_arrow"},[t._v("►")]),t._m(0)])},i=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"step_block e-btn"},[a("span",[t._v("03")]),a("span",[t._v(" 完成訂單")])])}],n={name:"CartStep",props:{hasClass:Boolean}},r=n,c=a("2877"),o=Object(c["a"])(r,s,i,!1,null,null,null);e["a"]=o.exports}}]);
//# sourceMappingURL=Cart.ac0b617a.js.map